<!DOCTYPE html>
<html lang="kr"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>이미지 분류 개념 | 🧠SUBBRAIN</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="이미지 분류 개념" />
<meta property="og:locale" content="kr" />
<meta name="description" content="style: number min_depth: 2 max_depth: 3 varied_style: true 이미지 분류(Image Classification Competition) 개념" />
<meta property="og:description" content="style: number min_depth: 2 max_depth: 3 varied_style: true 이미지 분류(Image Classification Competition) 개념" />
<link rel="canonical" href="http://localhost:4000/articles/AI/CV/%EC%9D%B4%EB%AF%B8%EC%A7%80%20%EB%B6%84%EB%A5%98%20%EA%B0%9C%EB%85%90.html" />
<meta property="og:url" content="http://localhost:4000/articles/AI/CV/%EC%9D%B4%EB%AF%B8%EC%A7%80%20%EB%B6%84%EB%A5%98%20%EA%B0%9C%EB%85%90.html" />
<meta property="og:site_name" content="🧠SUBBRAIN" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-12-14T13:41:08+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="이미지 분류 개념" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-12-14T13:41:08+09:00","datePublished":"2022-12-14T13:41:08+09:00","description":"style: number min_depth: 2 max_depth: 3 varied_style: true 이미지 분류(Image Classification Competition) 개념","headline":"이미지 분류 개념","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/articles/AI/CV/%EC%9D%B4%EB%AF%B8%EC%A7%80%20%EB%B6%84%EB%A5%98%20%EA%B0%9C%EB%85%90.html"},"url":"http://localhost:4000/articles/AI/CV/%EC%9D%B4%EB%AF%B8%EC%A7%80%20%EB%B6%84%EB%A5%98%20%EA%B0%9C%EB%85%90.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="🧠SUBBRAIN" /><link rel="icon" type="image/x-icon" href="/assets/img/common/favicon.ico">
</head>
<div class="scrollWrapper">
  <div class="scrollbar"></div>
  <div class="progressbar"></div>
  <div class="scrollbarButton"></div>
</div>

<link rel="stylesheet" href="/assets/css/obsidian/obs-scrollbar.css" />

<!--<div class="redirection">
  <h1 class="name">Redirection for full experience.</h1>
  <br>
  Move to <br /> <a class="to" href="#">netlify url</a><br />
  <div>after <span class="counter">10</span>secs.</div>
  press <button class="cancle">here</button> to cancle.
</div>
<div class="overlay"></div>
<script type="module" src="/assets/scripts/common/components/init_redirection.js"></script>

<link rel="stylesheet" href="/assets/css/common/redirection.css" />-->

<body><header class="site-header" role="banner">

  <div class="wrapper" style="display: flex; justify-content: space-between;"><div id="header-wrapper">
    <a class="site-title" rel="author" href="/blog">🧠SUBBRAIN</a>

    </div><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><script src="https://unpkg.com/lunr/lunr.js"></script>
<link rel="stylesheet" href="/assets/css/common/searchbar.css" />

<form id="search-form" method="get">
  <span id="search-wrapper">
    <span id="tag-holder" ></span>
    <input type="text" id="search-box" placeholder='Prefix "#" to add Tag.' autocomplete="off">
    <span class="inner-search" >🔍</span>
  </span>
</form><a class="page-link" href="/">ABOUT ME</a><a class="page-link" href="/blog">ALL ARTICLES</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
    <link rel="stylesheet" href="/assets/css/common/drawer.css" />
<button class="drawer-button open">▶️</button>
<div id="drawer" class="close">
  <button class="drawer-button close">
    ◀️
  </button>
  <div class="drawer-content">
    <div class="my-description">
      <div class="avatar-section" style="display: flex; flex-direction: row;">

        <img src="/assets/img/common/avatar.png" alt="avatar" class="avatar">
        <div style="display: flex; flex-direction: column; margin-left: 5px;">
          <a href="/about/">
            <h3 class="name">ROADVIRUSHN</h3>
          </a>
          <div class="stack-list" style="margin: 5px 0 0 5px;">
            <a title="My github page" href="https://github.com/RoadVirusHN">
  <svg class="svg-icon" width="16" height="16" viewBox="0 0 16 16">
    <use xlink:href="/assets/svg/social-icons.svg#github"></use>
  </svg>
</a>
<a title="My G-mail" href="mailto:roadvirushn@gmail.com">
  <svg class="svg-icon" width="16" height="16" viewBox="0 0 16 16">
    <use xlink:href="/assets/svg/social-icons.svg#gmail"></use>
  </svg>
</a>
<a title="My Blog" href="https://luminous-bubblegum-8e9be4.netlify.app">
  <svg class="svg-icon" width="16" height="16" viewBox="0 0 16 16">
    <use xlink:href="/assets/svg/social-icons.svg#blog"></use>
  </svg>
</a>
          </div>
        </div>
        <!-- <h4 class="name">(JUNSEOK YUN)</h4> -->
      </div>
      <p style="margin: 5px 0 0 0;">
        풀스택 웹🌐 개발자 지망생 🧑🏽‍💻
        <br>
        ➕ 인공지능 관심 🤖
      </p>
    </div>
      <hr>
      <div class="categories">
        <h3 style="margin: 0;"><a href="/">Categories</a></h3>
        <ul class="category-list">
  
  
  
  <li>
    <strong style="font-size: larger;">┣ </strong>
    <h3 style="display: inline;">
      
      <a href="/categories/COMPUTER_SCIENCE/" class="category-drop-down">▶</a>
      
      <span class="category-link">COMPUTER_SCIENCE</span>
    </h3>
    <span style="font-size: xx-small;">
       
      📂: 7
    </span>
    <ul class="child-category-list">
      
      <li>
        <strong style="font-size: larger;">
          ┃  
          ┣ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/COMPUTER_SCIENCE/DATABASE/">DATABASE</a>
        </h4>
          <span style="font-size: xx-small;">
            📄: 1 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          ┃  
          ┣ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/COMPUTER_SCIENCE/ALGORITHM/">ALGORITHM</a>
        </h4>
          <span style="font-size: xx-small;">
            📄: 16 
            📂: 1
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          ┃  
          ┣ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/COMPUTER_SCIENCE/OS/">OS</a>
        </h4>
          <span style="font-size: xx-small;">
            📄: 2 
            📂: 1
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          ┃  
          ┣ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/COMPUTER_SCIENCE/NETWORK/">NETWORK</a>
        </h4>
          <span style="font-size: xx-small;">
            📄: 8 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          ┃  
          ┣ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/COMPUTER_SCIENCE/ETC/">ETC</a>
        </h4>
          <span style="font-size: xx-small;">
            📄: 1 
            📂: 1
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          ┃  
          ┣ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/COMPUTER_SCIENCE/OSSU/">OSSU</a>
        </h4>
          <span style="font-size: xx-small;">
             
            📂: 1
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          ┃  
          ┗ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/COMPUTER_SCIENCE/PL/">PL</a>
        </h4>
          <span style="font-size: xx-small;">
             
            📂: 1
          </span>
      </li>
      
    </ul>
  </li>
  
  
  <li>
    <strong style="font-size: larger;">┣ </strong>
    <h3 style="display: inline;">
      
      <a href="/categories/WEB/" class="category-drop-down">▶</a>
      
      <span class="category-link">WEB</span>
    </h3>
    <span style="font-size: xx-small;">
       
      📂: 3
    </span>
    <ul class="child-category-list">
      
      <li>
        <strong style="font-size: larger;">
          ┃  
          ┣ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/WEB/FRONTEND/">FRONTEND</a>
        </h4>
          <span style="font-size: xx-small;">
            📄: 2 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          ┃  
          ┣ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/WEB/BACKEND/">BACKEND</a>
        </h4>
          <span style="font-size: xx-small;">
            📄: 2 
            📂: 2
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          ┃  
          ┗ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/WEB/CI,CD/">CI,CD</a>
        </h4>
          <span style="font-size: xx-small;">
            📄: 2 
            📂: 2
          </span>
      </li>
      
    </ul>
  </li>
  
  
  <li>
    <strong style="font-size: larger;">┣ </strong>
    <h3 style="display: inline;">
      
      <a href="/categories/ETC/" class="category-drop-down">▶</a>
      
      <span class="category-link">ETC</span>
    </h3>
    <span style="font-size: xx-small;">
       
      📂: 2
    </span>
    <ul class="child-category-list">
      
      <li>
        <strong style="font-size: larger;">
          ┃  
          ┣ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/ETC/ETCS/">ETCS</a>
        </h4>
          <span style="font-size: xx-small;">
            📄: 8 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          ┃  
          ┗ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/ETC/SUBBRAIN 개발기/">SUBBRAIN 개발기</a>
        </h4>
          <span style="font-size: xx-small;">
            📄: 5 
            
          </span>
      </li>
      
    </ul>
  </li>
  
  
  <li>
    <strong style="font-size: larger;">┗ </strong>
    <h3 style="display: inline;">
      
      <a href="/categories/AI/" class="category-drop-down">▶</a>
      
      <span class="category-link">AI</span>
    </h3>
    <span style="font-size: xx-small;">
       
      📂: 9
    </span>
    <ul class="child-category-list">
      
      <li>
        <strong style="font-size: larger;">
          &nbsp;&nbsp;&nbsp;
          ┣ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/AI/AITOOLS/">AITOOLS</a>
        </h4>
          <span style="font-size: xx-small;">
            📄: 3 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          &nbsp;&nbsp;&nbsp;
          ┣ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/AI/CV/">CV</a>
        </h4>
          <span style="font-size: xx-small;">
            📄: 2 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          &nbsp;&nbsp;&nbsp;
          ┣ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/AI/DEEP_LEARNING/">DEEP_LEARNING</a>
        </h4>
          <span style="font-size: xx-small;">
            📄: 1 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          &nbsp;&nbsp;&nbsp;
          ┣ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/AI/DATA_VIS/">DATA_VIS</a>
        </h4>
          <span style="font-size: xx-small;">
            📄: 2 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          &nbsp;&nbsp;&nbsp;
          ┣ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/AI/GRAPH/">GRAPH</a>
        </h4>
          <span style="font-size: xx-small;">
            📄: 1 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          &nbsp;&nbsp;&nbsp;
          ┣ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/AI/LIGHTWEIGHT/">LIGHTWEIGHT</a>
        </h4>
          <span style="font-size: xx-small;">
            📄: 1 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          &nbsp;&nbsp;&nbsp;
          ┣ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/AI/MATH/">MATH</a>
        </h4>
          <span style="font-size: xx-small;">
            📄: 1 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          &nbsp;&nbsp;&nbsp;
          ┣ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/AI/NLP/">NLP</a>
        </h4>
          <span style="font-size: xx-small;">
            📄: 3 
            
          </span>
      </li>
      
      <li>
        <strong style="font-size: larger;">
          &nbsp;&nbsp;&nbsp;
          ┗ 
        </strong>
        <h4 style="display: inline; background-color: lightgray; padding: 0px 1px; border-radius: 2px;">
          <a class="category-link" href="/categories/AI/STRUCTURED_DATA/">STRUCTURED_DATA</a>
        </h4>
          <span style="font-size: xx-small;">
            📄: 2 
            
          </span>
      </li>
      
    </ul>
  </li>
  
</ul>
      </div>
      <hr>
      <div class="recent-view">
        <h3 style="margin: 0;">Recent views</h3>
        <ul style="margin: 0;">
          <li>
            <strong style="color:rgb(219, 219, 12);">1 <a id="recent-1"></a></strong>
          </li>
          <li>
            2 <a id="recent-2"></a>
          </li>
          <li>
            3 <a id="recent-3"></a>
          </li>
          <li>
            4 <a id="recent-4"></a>
          </li>
          <li>
            5 <a id="recent-5" style="overflow: hidden;"></a>
          </li>
        </ul>
      </div>
    </div>
    <hr>
  <div style="height: 7vh;"></div>
</div>
    <div class="wrapper">
      <article class="article h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="article-header">
    <h1 class="article-title a-name" itemprop="name headline">이미지 분류 개념</h1>
    <p class="article-meta">
      <time class="dt-published" datetime="2022-12-14T13:41:08+09:00" itemprop="datePublished">Dec 14, 2022
      </time></p>
  </header>

  <div class="article-content e-content" itemprop="articleBody">
     
  
<script>
  MathJax = {
    tex: {
      inlineMath: [
        ["$", "$"],
        ["\\(", "\\)"],
      ],
    },
    svg: {
      fontCache: "global",  
     // scale: 1.5,
    },
    chtml: {
     // scale: 1.5,
    },
  };
</script>
<script
  type="text/javascript"
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"
></script>
 
 


<script src="/assets/scripts/bundle/obsidian.bundle.js"></script>
<link rel="stylesheet" href="/assets/css/obsidian/callout.css" />
<link rel="stylesheet" href="/assets/css/obsidian/image.css" />
<link rel="stylesheet" href="/assets/css/obsidian/link-warning.css" />
<link rel="stylesheet" href="/assets/css/obsidian/preview.css" />

<div class="content-section">
  <html><head></head><body><ol id="markdown-toc-0"><li lvl="2"><a id="markdown-toc-0-0" href="#EDA-Exploratory-Data-Analysis-탐색적-데이터-분석">EDA(Exploratory Data Analysis, 탐색적 데이터 분석)</a><ul><li lvl="3"><a id="markdown-toc-0-1" href="#EDA란">EDA란?</a><ul></ul></li><li lvl="3"><a id="markdown-toc-0-2" href="#Image-Classification">Image Classification</a><ul></ul></li></ul></li><li lvl="2"><a id="markdown-toc-0-3" href="#Dataset">Dataset</a><ul><li lvl="3"><a id="markdown-toc-0-4" href="#Pre-processing">Pre-processing</a><ul></ul></li></ul></li><li lvl="2"><a id="markdown-toc-0-5" href="#Generalization">Generalization</a><ul><li lvl="3"><a id="markdown-toc-0-6" href="#Bias-Variance">Bias &amp; Variance</a><ul></ul></li><li lvl="3"><a id="markdown-toc-0-7" href="#Train-Validation">Train/Validation</a><ul></ul></li><li lvl="3"><a id="markdown-toc-0-8" href="#Data-Augmentation">Data Augmentation</a><ul></ul></li></ul></li><li lvl="2"><a id="markdown-toc-0-9" href="#Data-Generation">Data Generation</a><ul><li lvl="3"><a id="markdown-toc-0-10" href="#Data-Feeding">Data Feeding</a><ul></ul></li><li lvl="3"><a id="markdown-toc-0-11" href="#torch-utils-data">torch.utils.data</a><ul></ul></li></ul></li><li lvl="2"><a id="markdown-toc-0-12" href="#Model">Model</a><ul><li lvl="3"><a id="markdown-toc-0-13" href="#Design-Model-wtih-Pytorch">Design Model wtih Pytorch</a><ul></ul></li><li lvl="3"><a id="markdown-toc-0-14" href="#Pretrained-Model">Pretrained Model</a><ul></ul></li><li lvl="3"><a id="markdown-toc-0-15" href="#Transfer-Learning">Transfer Learning</a><ul></ul></li></ul></li><li lvl="2"><a id="markdown-toc-0-16" href="#Training-Inference">Training &amp; Inference</a><ul><li lvl="3"><a id="markdown-toc-0-17" href="#Loss-Optimizer-Metric">Loss, Optimizer, Metric</a><ul></ul></li><li lvl="3"><a id="markdown-toc-0-18" href="#Training-Process">Training Process</a><ul></ul></li><li lvl="3"><a id="markdown-toc-0-19" href="#Inference-Process">Inference Process</a><ul></ul></li></ul></li><li lvl="2"><a id="markdown-toc-0-20" href="#Ensemble-앙상블">Ensemble(앙상블)</a><ul></ul></li><li lvl="2"><a id="markdown-toc-0-21" href="#Hyperparametr-Optimization">Hyperparametr Optimization</a><ul></ul></li><li lvl="2"><a id="markdown-toc-0-22" href="#Experiment-Toolkits-Tips">Experiment Toolkits &amp; Tips</a><ul><li lvl="3"><a id="markdown-toc-0-23" href="#Training-Visualization">Training Visualization</a><ul></ul></li></ul></li></ol>
<h1 id="이미지-분류-Image-Classification-Competition-개념">이미지 분류(Image Classification Competition) 개념</h1>

<blockquote>
  <p>네이버 AI BoostCamp의 P stage 이미지 분류 강의를 정리하였습니다.</p>
</blockquote>

<p>## Competition with AI Stages</p>

<p><strong>Competition이란?</strong></p>

<p><img src="/assets/img/이미지 분류 개념/image-20210329121207833.png" alt=""><img src="/assets/img/이미지 분류 개념/image-20210329121158502.png" alt=""></p>

<p>여러 회사, 단체 등에서 상금을 내걸고 데이터를 제공하여 원하는 결과를 얻는 가장 좋은 방법을 모색한다.</p>

<ul>
  <li>데이터 뿐만 아니라 컴퓨팅 자원을 지원할 때도 있다.</li>
</ul>

<p>Kaggle이 competition platform으로 대표적이며, 국내에서는 DACON 이 존재한다.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">&nbsp;</th>
      <th style="text-align: center">Pipeline</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">ML pipeline</td>
      <td style="text-align: center"><img src="/assets/img/이미지 분류 개념/image-20210329123936670.png" alt=""></td>
    </tr>
    <tr>
      <td style="text-align: center">Competition pipeline</td>
      <td style="text-align: center"><img src="/assets/img/이미지 분류 개념/image-20210329123944543.png" alt=""></td>
    </tr>
  </tbody>
</table>

<p>실제 머신러닝 업무의 Pipeline과 Competition의 Pipeline이 비슷한 경우가 많기 때문에 Competition을 통해 ML 실력을 갈고 닦기 좋다!</p>

<p><strong>Overview</strong></p>

<p><img src="/assets/img/이미지 분류 개념/image-20210329121716649.png" alt=""></p>

<p>문제에 대한 정의, 요구사항과 직면하고 있는 문제점 등에 대해서 자세히 알 수 있다.</p>

<p>위의 경우, 단순히 악성 댓글을 파악하는 문제가 아니라, 악성댓글 파악 중 야기되는 정치적 이슈에 대한 설명이 포함되어 있다.</p>

<p>위의 overview를 자세히 보는 것으로 내가 풀어나가야할 문제에 대한 방향성을 얻어낼 수 있으며, 이러한 행위를 Problem Definition(문제 정의)라고 한다.</p>

<p>이러한 문제 정의 행위로는</p>

<ol>
  <li>내가 무슨 문제를 풀어야 하는가?</li>
  <li>Input과 Output은 무엇인가?</li>
  <li>이 솔루션은 어디서 어떻게 사용되어지는가?</li>
</ol>

<p>등의 예시가 있다.</p>

<p><strong>Data Description</strong></p>

<p><img src="/assets/img/이미지 분류 개념/image-20210329122428314.png" alt=""></p>

<p>File 형태, Metadata Field 소개 및 설명이 적혀있는 부분</p>

<p>데이터 스팩의 요약본, EDA, 문제정의 등에 중요하다.</p>

<p><strong>Notebook</strong></p>

<p><img src="/assets/img/이미지 분류 개념/image-20210329122636119.png" alt=""></p>

<p>데이터 분석, 모델 학습, 테스트 셋 추론의 과정을 서버에서 연습 가능</p>

<p>단순히 연습용이 아니라, 일부 Competition의 경우는 회사에서 이러한 방식으로 Computing power를 제공하는 경우도 있으며, 성능을 강제하기 위해 사용이 강요되는 경우도 있다.</p>

<p><strong>Submission</strong></p>

<p><img src="/assets/img/이미지 분류 개념/image-20210329122950431.png" alt=""></p>

<p>자신이 제출했던 테스트 예측 결과물들의 정보를 확인하고, 제출할 결과물을 선택할 수 있다.</p>

<p><strong>Leaderboard</strong></p>

<p><img src="/assets/img/이미지 분류 개념/image-20210329123023255.png" alt=""></p>

<p>자신의 제출물의 순위를 확인할 수 있다.</p>

<p><strong>Discussion</strong></p>

<p><img src="/assets/img/이미지 분류 개념/image-20210329123057805.png" alt=""></p>

<p>Kaggle 등에서는 Discussion에서 다양한 정보를 주고 받는 문화가 발달함.</p>

<p>정보를 공유함으로, 경쟁자의 점수가 올라갈 수 있음에도 불구하고, 등수를 올리는 것 보단 문제를 해결하고 싶은 마음으로 올리는 경우가 많음.</p>

<p>하지만 경연 종료 1~2주 전에는 보통 Critical한 정보의 공유는 멈춰지는 경우가 많다.</p>

<p>ML에 관한 정보뿐만 아니라, 도메인 지식, CS 지식 등도 공유된다.</p>

<h2 id="EDA-Exploratory-Data-Analysis-탐색적-데이터-분석">EDA(Exploratory Data Analysis, 탐색적 데이터 분석)</h2>

<p><img src="/assets/img/이미지 분류 개념/image-20210329144512799.png" alt=""></p>

<p>EDA는 ML pipeline 중 Data Analysis 부분에 해당한다</p>

<h3 id="EDA란">EDA란?</h3>

<p>EDA(Exploratory Data Analysis, 탐색적 데이터 분석), 데이터를 이해하기 위한 노력</p>

<p>데이터의 구성, 형태, 쓰임새 등을 분석하는 것</p>

<ul>
  <li>주제와 연관성, 데이터 타입의 특성, 메타데이터의 분포 등이 있다.</li>
</ul>

<p>머신러닝 파이프라인에 많은 것에 영향을 주게 된다.</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210329142136911.png" alt=""></p>

<p>EDA 결과물의 예시, 데이터 이해가 목적이므로 정해진 툴이나 절차 없이 궁금한 점을 찾아보는 과정이다.</p>

<p>또한, 한번으로 끝나는 과정이 아니며, 언제나 의문이 생기면 EDA는 pipeline 과정 중간에 언제나 돌아올 수 있다.</p>

<p>툴로는 python, excel 등이 존재</p>

<h3 id="Image-Classification">Image Classification</h3>

<p>이미지란, 시작적 인식을 표현한 인공물(Artifact)</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210329151150104.png" alt=""></p>

<p>채널이 3개인 경우 RGB(Red, Green, Blue),  채널이 4개인 겨우 CMYK(Cyan, Magenta, Yellow, Black), 또는 RGBA(+alpha)를 표현한 경우가 많다.</p>

<p>uint8(unsinged integeter 8bit)로 표현하는 경우가 많으며, 0~255까지 256의 범위를 가진다.</p>

<h2 id="Dataset">Dataset</h2>

<p><img src="/assets/img/이미지 분류 개념/image-20210330100946006.png" alt=""></p>

<p>Dataset 형성, Data Generation은 Data Processing의 과정이다.</p>

<p>Raw Data를 모델이 사용할 수 있는 Dataset으로 만들면 다양한 모델이나 쓰임새에 쉽게 사용할 수 있을 뿐만 아니라 인간이 쉽게 이해할 수 있다.</p>

<h3 id="Pre-processing">Pre-processing</h3>

<p>Pre-processing(전처리)는 pipeline에 시간과 중요성, 비중 모두 커다란 부분을 차지하고 있다.</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210330101722733.png" alt=""></p>

<p>Competition data는 제대로된 Data를 주는 편이지만, 수집한 데이터의 경우 절반 이상을 날려야 하는 경우가 많음.</p>

<p>이미지의 전처리의 경우, 다음과 같은 예시가 있다.</p>

<ul>
  <li>Bounding box</li>
</ul>

<p><img src="/assets/img/이미지 분류 개념/image-20210330101926520.png" alt=""></p>

<p>이미지의 중요한 부분을 Crop한 뒤 Resize하여 학습시킬 모델을 더욱 명확히 함</p>

<p>좌측 상단과 우측 하단의 좌표를 이용해 Bounding box를 그릴 수 있음</p>

<ul>
  <li>Resize</li>
</ul>

<p><img src="/assets/img/이미지 분류 개념/image-20210330101939193.png" alt=""></p>

<p>계산효율을 위해 적당한 크기로 이미지 사이즈 변경</p>

<p>이미지 사이즈가 바뀌어도 성능에 영향은 미미한 경우가 많다.</p>

<ul>
  <li>이미지 채도, 대비 변경</li>
</ul>

<p><img src="/assets/img/이미지 분류 개념/image-20210330102840559.png" alt=""></p>

<p>상단은 홍채 사진을 더욱 뚜렷히 바꾼 것</p>

<p>명확하지 않은 사진을 채도, 대비, 명도,등을 바꾸어 선명하게 바꿈</p>

<p>전처리가 성능의 향상을 보장하진 않는다.</p>

<h2 id="Generalization">Generalization</h2>

<h3 id="Bias-Variance">Bias &amp; Variance</h3>

<p><img src="/assets/img/이미지 분류 개념/image-20210330103626980.png" alt=""></p>

<p>Underfitting : 학습이 부족하여 제대로 구별할 수 없음</p>

<p>Overfitting : noise를 포함해서 모든 학습이 너무 많이되어 너무 자세하게 구분함</p>

<p>일반화, 즉 학습한 데이터셋 이외의 Input에서는 부정확한 결과를 내게 됨</p>

<h3 id="Train-Validation">Train/Validation</h3>

<p><img src="/assets/img/이미지 분류 개념/image-20210330105057803.png" alt=""></p>

<p>훈련 셋 중 일정 부분을 따로 분리하여 검증 셋으로 활용</p>

<p>학습 가능한 데이터양이 줄어들지만, 학습되지 않은 Validation Set의 분포를 통해 일반화 성능을 검증할 수 있다.</p>

<p>검증 절차를 통해 Generalization(일반화) 성능을 늘릴 수 있다.</p>

<h3 id="Data-Augmentation">Data Augmentation</h3>

<p><img src="/assets/img/이미지 분류 개념/image-20210330105400221.png" alt=""></p>

<p>데이터를 일반화하는 과정, 주어진 데이터가 가질 수 있는 Case(경우), State(상태)를 다양하게 함.</p>

<p>이미지의 경우 다양한 필터, 채도, 색상 변경, 이미지 회전, Crop 등, 원본 이미지를 변경하는 것을 통하여 데이터를 늘림.</p>

<p>문제가 만들어진 배경과 모델의 쓰임새를 살표보아 Data Augmentation의 힌트를 얻을 수 있다.</p>

<p>(ex)밤과 낮에 따로 촬영될 수 있는가? -&gt; 명도 변경)</p>

<p>torchvision.transforms 에서 Image에 적용 가능한 다양한 함수를 살펴볼 수 있다.</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210330110154448.png" alt=""></p>

<p><img src="/assets/img/이미지 분류 개념/image-20210330110312284.png" alt=""></p>

<p>Albumentations라는 Library는 좀 더 처리가 빠르고 다양한 기능을 제공함</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210330110449254.png" alt=""></p>

<h2 id="Data-Generation">Data Generation</h2>

<p>데이터 전처리, Augmentation 등의 출력 결과가 모델의 성능, 시간 등에 영향을 주는 경우가 많다.</p>

<h3 id="Data-Feeding">Data Feeding</h3>

<p><img src="/assets/img/이미지 분류 개념/image-20210330114004455.png" alt=""></p>

<p>모델의 학습속도와 이전 단계가 느리다면 전체적인 학습속도가 느려질 수 밖에 없다.</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210330114020650.png" alt=""></p>

<p>단순히 Data Augmentation의 순서가 달라지는 것 많으로도 성능이 달라진다.</p>

<p>데이터셋 생성능력을 비교하여 적절한 성능을 정해보자.</p>

<h3 id="torch-utils-data">torch.utils.data</h3>

<p><strong>Dataset</strong></p>

<p>pytorch에서 정의할 수 있는 데이터셋 생성 방법은 다음과 같다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span>

<span class="k">class</span> <span class="nc">MyDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span> <span class="c1"># torch.utils.data.Dataset 상속
</span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># MyDataset 클래스가 처음 선언되었을 때 호출
</span>        <span class="k">print</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;Class init!!&amp;#34;)
</span>        <span class="k">pass</span>
    <span class="c1"># test = MyDataset() 결과: # Class init!!
</span>   	
    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span> <span class="c1"># MyDataset의 데이터 중 index 위치의 아이템을 리턴
</span>        <span class="k">return</span> <span class="n">index</span>
   	<span class="c1"># test[2341] 결과: # 2341
</span>    
	<span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># MyDataset 아이템의 전체 길이
</span>        <span class="k">print</span><span class="p">(</span><span class="o">&amp;</span><span class="c1">#34;length is 3&amp;#34;)
</span>        <span class="k">return</span> <span class="mi">3</span>
    <span class="c1"># len(test) 결과: # lenth is 3 # 3
</span>
</code></pre></div></div>
<p>이를 통해 Vanilla 데이터를 원하는 형태로 출력 가능</p>

<p><strong>DataLoader</strong></p>

<p>Dataset을 효율적으로 사용할 수 있도록 관련 기능 추가</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">DataLodaer</span><span class="p">(</span>
<span class="n">train_set</span><span class="p">,</span>
<span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="c1"># batch 사이즈
</span><span class="n">num_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">,</span> <span class="c1"># 병렬 코어 갯수
</span><span class="n">drop_last</span><span class="o">=</span><span class="bp">True</span> <span class="c1"># batch 사이즈에 맞지 않는 마지막 batch 버림
</span><span class="p">)</span>

</code></pre></div></div>
<p>이외에도 shufle, sampler, batch_sampler, pin_memory 등 여러 기능이 있다.</p>

<p>collate_fn : batch 단위 마다 실행할 함수 넣어주기</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210330133541405.png" alt=""></p>

<p>num_workers 사용 결과</p>

<p>너무 큰 값을 사용하면, 딥러닝 이외의 시스템에서의 사용하는 연산이 간섭하여 오히려 성능이 떨어진다고 함.</p>

<h2 id="Model">Model</h2>

<p><img src="/assets/img/이미지 분류 개념/image-20210331095140379.png" alt=""></p>

<p>모델은 데이터셋을 Input으로 받아 원하는 출력을 만들어 준다.</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210331095303582.png" alt=""></p>

<p>객체의 정보적 표현을 모델이라고 한다.</p>

<h3 id="Design-Model-wtih-Pytorch">Design Model wtih Pytorch</h3>

<p><img src="/assets/img/이미지 분류 개념/image-20210331100639097.png" alt=""></p>

<p>사용성 좋고 연구에 편리한(Pythonic) Low level 오픈소스 머신러닝 프레임워크</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210331102230452.png" alt=""></p>

<p>좌 keras 코드와 우 pytorch 코드를 비교하면 좀더 Low level에 가까운 것을 알 수 있다.</p>

<p>이를 통해 원리의 이해와 customizing이 좀더 쉽다.</p>

<p><strong>nn.Module</strong></p>

<p><img src="/assets/img/이미지 분류 개념/image-20210331102719982.png" alt=""></p>

<p>Pytorch 모델의 모든 레이어는 nn.Module 클래스를 따른다.</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210331103816260.png" alt=""></p>

<p>modules 함수를 통해 내부에 nn.Module를 상속하는 layer들을 확인할 수 있다.</p>

<p>nn.Module 클래스는 일종의 정보를 저장하는 저장소 역할을 하며 이를 상속받아 layer(모델, layer 등)를 만든다.</p>

<ul>
  <li>이때 모델 내부의 conv layer 같은 layer들은 child 모듈이라고 하며, nn.Module을 상속받은 모든 클래스의 공통된 특징이다.
    <ul>
      <li>이 특징을 통해 연결된 모든 module을 확인할 수 있다.</li>
    </ul>
  </li>
</ul>

<p>이후 이 모델이 호출 되었을 때는 forward() 함수가 불러진다.</p>

<p>이때 input을 넣어주며, 또는 직접 모델명.forward(input)으로 불러도 된다.</p>

<ul>
  <li>최상위 nn.module의 forward() 함수 실행으로 정의된 모듈 각각의 forward()가 모두 실행된다.</li>
</ul>

<p><strong>Parameter</strong></p>

<p><img src="/assets/img/이미지 분류 개념/image-20210331110502417.png" alt=""></p>

<p>module 내부에는 Tensor 기반의 parameter를 가지고 있을 수 있다.</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210331110544054.png" alt=""></p>

<p>parameter는 또한, data, grad, requires_grad 등의 변수를 가지고 있으며</p>

<ul>
  <li>
    <p>data : paremater의 수치</p>
  </li>
  <li>
    <p>grad : loss에 의해 정해진 gradient 값</p>
  </li>
  <li>
    <p>requires_grad : boolean, 해당 parameter를 backpropagation 시 업데이트 할 것인가?</p>
  </li>
</ul>

<p>이런 식으로 파이토치는 형식과 구조를 파악하고 응용하기 쉬우며 디버깅도 쉽다</p>

<h3 id="Pretrained-Model">Pretrained Model</h3>

<p>대량의 데이터셋, 오래 걸리는 학습 시간, 복잡한 레이어 구축 등을 고려하면 처음부터 모델의 모든 것을 만드는 것은 힘들다.</p>

<p>그러므로 YOLO와 같이 미리 만들어지고 학습된 Pretrained Model을 내 Task에 맞게 다듬어서 사용하면 이러한 노력을 줄이면서도 성능을 보장할 수 있다.</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210331123156740.png" alt=""></p>

<p>Pretrained model의 발전에는 일반화가 뛰어나고 데이터의 양과 질이 뛰어난 오픈소스 데이터셋인 IMAGENET의 등장에서 부터 시작되었다.</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210331142139009.png" alt=""></p>

<p>TorchVision 등에서 손쉽게 이용 가능하며, pretrained=True로 설정시, 구조 뿐만 아니라 학습한 weight 또한 같이 가져온다.</p>

<h3 id="Transfer-Learning">Transfer Learning</h3>

<p>앞서 가져온 Pretrained model을 우리가 원하는 용도로 사용하기 위해 학습하는 것을 Transfer Learning이라고 한다.</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210331151429231.png" alt=""></p>

<p>나의 Task와 비교하여 적절한 Transfer Learning 방법을 고려해야 한다.</p>

<ol>
  <li>학습데이터가 충분한 경우</li>
</ol>

<p><img src="/assets/img/이미지 분류 개념/image-20210331152156297.png" alt=""></p>

<p>Task가 ImageNet과 비슷할 경우, Classifier만 학습시킨다.(<em>feature-extraction, 특색 추출</em>)</p>

<p>Task가 ImageNet과 비슷하지 않을 경우, Classifier뿐만 아니라 CNN Backbone또한 다시 학습시킨다.(<em>Fine-tuning, 미세 조정</em>)</p>

<ul>
  <li>이때 구조만 살리고 처음부터 하는 것이 아니라, 기존의 weight를 가지고 있는 채로 다시 학습하는 것이다.(보통 성능이 더욱 좋다.)</li>
</ul>

<ol>
  <li>학습 데이터가 충분하지 않은 경우</li>
</ol>

<p><img src="/assets/img/이미지 분류 개념/image-20210331152357033.png" alt=""></p>

<p>Task가 ImageNet과 비슷할 경우, Classifier만 학습시킨다.</p>

<p>Task가 ImageNet과 비슷하지 않을 경우, 성능이 그리 높지 않으므로 추천하진 않는다.</p>

<h2 id="Training-Inference">Training &amp; Inference</h2>

<p><img src="/assets/img/이미지 분류 개념/image-20210401095438363.png" alt=""></p>

<h3 id="Loss-Optimizer-Metric">Loss, Optimizer, Metric</h3>

<p>Training에 필요한 요소는 크게</p>

<ul>
  <li>Loss</li>
  <li>Optimizer</li>
  <li>Metric</li>
</ul>

<p>으로 나뉜다.</p>

<h4 id="Loss">Loss</h4>

<p><img src="/assets/img/이미지 분류 개념/image-20210401095742828.png" alt=""></p>

<p>Loss 값은 정답인 Target과 예상값인 Output의 차이를 Loss 함수(Cost 함수, Error 함수)를 통하여 구한다.</p>

<ul>
  <li>Loss 함수는 목적이나 Task 등에 따라 잘 골라줘야 한다.</li>
</ul>

<p>이후 Error Backpropation을 통해 가중치가 업데이트 되게 된다.</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210401100138025.png" alt=""></p>

<p>nn 패키지 내부의 Loss함수 또한 Module을 상속하고 있으며, 이를 통해 모델 등의 child Module이 되어 보여지거나 Forward가 존재하는 등의 특징을 갖는다.</p>

<p>그래서 커스텀 Loss를 만들려면 Module을 상속해야 함.</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210401100427483.png" alt=""></p>

<p>criterion(관용적인 변수명)에 loss 함수를 정의한 뒤 output과 labels를 넣어 구한 loss의 backward 함수가 실행되면 모델의 파라미터 grad가 업데이트된다.</p>

<p>업데이트하지 않고 Freeze하고 싶으면 requires_grad를 false로 설정하면 된다.</p>

<ul>
  <li>이때 모델(net)-&gt;output-&gt;criterion-&gt;loss 순으로 연결이 되는 체인을 통하여 backpropation이 가능하게 된다.</li>
</ul>

<p>Loss 함수에 조금 과정을 추가한 특별한 Loss 또한 존재한다.</p>

<p><em>Focal Loss</em> : Class Imbalance 문제를 해결하기 위해 맞춘 확률이 높은 Class는 조금의 Loss를, 맞춘 확률이 낮은 Class는 Loss를 훨씬 높게 부여</p>

<p><em>Label Smoothing Loss</em> : Class target label을 Onehot 표현으로 사용하기 보다는 조금 Soft하게 표현해서 일반화 성능을 높임</p>

<ul>
  <li>즉 [0, 1, 0, 0, 0] 같은 형태 대신 [0.025, 0.9, 0.025, 0.025, …] 같은 형태</li>
</ul>

<h4 id="Optimizer">Optimizer</h4>

<p>Optimizer는 Loss 함수의 결과물인 Loss와 방향과 Learnig rate에 따라 weight를 업데이트 한다.<br>
\(w'=w-\eta\frac{\part E}{\part w}\\
\eta:Learning\ rate(학습률),\ \frac{\part E}{\part w}:방향, E: error\)<br>
<img src="/assets/img/이미지 분류 개념/image-20210401102109226.png" alt=""></p>

<p>Optimizer는 LR scheduler를 통해 Learning rate를 학습 중에 동적으로 조절할 수 있다.</p>

<p>Scheduler의 종류는 다음과 같다.</p>

<ol>
  <li>StepLR</li>
</ol>

<p>특정 Step 마다 LR 감소</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210401102240255.png" alt=""></p>

<ol>
  <li>CosineAnnealingLR</li>
</ol>

<p>Cosine 함수 형태처럼 LR을 급격히 변경</p>

<p>변화를 급격하게 주어, Local minimum에 빠지는 경우를 막음</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210401102336856.png" alt=""></p>

<ol>
  <li>ReduceLROnPlateau</li>
</ol>

<p>일반적으로 많이 사용함, 더 이상 성능 향상이 없을 때 LR 감소</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210401102600936.png" alt=""></p>

<h4 id="Metric">Metric</h4>

<p>학습된 모델을 객관적으로 평가할 수 있는 지표가 필요</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210401102948372.png" alt=""></p>

<p>R…은 ROCAOC</p>

<p>여러 Task, 목적, 데이터 상태 등에 따라 여러 Metric의 종류가 있다.</p>

<p>Ranking : 추천 시스템에 사용되는 경우가 많음.</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210401103204920.png" alt=""></p>

<p>상단의 예시처럼, 데이터의 편향 등에 따라 정확도가 다르게 나올 수 도 있다.</p>

<p>Classification의 경우,</p>

<p>그러므로 Class 별로 밸런스가 적절히 분포되었을 시, Accuracy,</p>

<p>Class 별 밸런스가 좋지 않을 경우 F1-Score를 사용하는게 좋다.</p>

<h3 id="Training-Process">Training Process</h3>

<p><img src="/assets/img/이미지 분류 개념/image-20210401111744185.png" alt=""></p>

<p>pytorch는 머신러닝의 과정을 잘알 수 있게 끔 구성되었다</p>

<p>우리는 앞서 Dataset, Model, Loss, Optimizer, Metric 등 Training을 하기 위한 준비에 대해 배웠다.</p>

<p>Training을 할때 코드를 이해해 보자.</p>

<ol>
  <li>Model.train()</li>
</ol>

<p>모듈을 상속한 객체를 training 모드로 바꿔준다.</p>

<p>training/evaluation 모드의 차이에 따라 Dropout이나 BatchNormalzation 등의 행동이 조금 달라지게 된다.</p>

<ol>
  <li>optimizer.zero_grad()</li>
</ol>

<p><img src="/assets/img/이미지 분류 개념/image-20210401112415462.png" alt=""></p>

<p>optimizer가 이전 batch 사용했던 Parameter들의 grad를 초기화해준다.</p>

<p>기본값이 아닌 이유는 Loss를 쌓아서 사용하는 방법도 존재하기 때문</p>

<ol>
  <li>loss = criterion(outputs, labels)</li>
</ol>

<p><img src="/assets/img/이미지 분류 개념/image-20210401113635199.png" alt=""></p>

<p><img src="/assets/img/이미지 분류 개념/image-20210401113909959.png" alt=""></p>

<p>loss 함수 또한 Module을 상속하므로 input 부터 output 까지 연결되는 체인이 생겨난다.</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210401114002370.png" alt=""></p>

<p>loss의 grad_fn chaing에 loss의 backward() 함수가 들어가 있으며, 내부에 next_fucntion을 통해 다음 layer와 죽 연결되어 있음을 확인할 수 있다.</p>

<ol>
  <li>optimizer.step()</li>
</ol>

<p><img src="/assets/img/이미지 분류 개념/image-20210401114310825.png" alt=""></p>

<p>step()를 실행하면 optimizer가 loss backward를 통해 업데이트된 gradient를 이용하여 weight들을 업데이트한다.</p>

<p>정확한 내부 로직은 optimizer 마다 다르다.</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210401114556658.png" alt=""></p>

<p>Gradient Accumulation은 optimizer의 step가 zero_grad를 특정 배수 epoch에만 실행한다.</p>

<p>batch size를 늘리는 것 과 같은 효과를 내면서 동시에 batch size를 늘렸을 때의 성능 요구를 줄였다.</p>

<h3 id="Inference-Process">Inference Process</h3>

<ol>
  <li>model.eval()</li>
</ol>

<p>모델을 evaluation 모드로 바꾼다. 위의 train()과 같은 이유</p>

<ol>
  <li>with torch.no_grad():</li>
</ol>

<p><img src="/assets/img/이미지 분류 개념/image-20210401121701696.png" alt=""></p>

<p>with torch.no_grad()내부 로직일때는 모든 parameter들이 require_grad=False 인 상태와 같아진다.</p>

<p>Inference 중일때는 내부 parameter가 업데이트 되지 않는다.</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210401122016260.png" alt=""></p>

<p>Validation data로 Inference 하는 코드가 검증 코드이다.</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210401122117703.png" alt=""></p>

<p>checkpoint는 inference 결과를 보고 모델을 저장하면 된다.</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210401122319980.png" alt=""></p>

<p>마지막으로 eval의 결과를 submission으로 바꾸어 제출하면 된다.</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210401122702520.png" alt=""></p>

<p>PyTorch Lightning을 이용하면 코드를 좀더 간결하고 읽기 쉽게 사용할 수 있다.</p>

<h2 id="Ensemble-앙상블">Ensemble(앙상블)</h2>

<p>싱글 모델보다 더 나은 성능을 위해 서로 다른 여러 학습 모델을 사용하는 것</p>

<p>효과는 있지만, 학습, 추론 시간이 배로 소모됨</p>

<p>딥러닝은 Overfitting이 생길 경향이 상당히 많다.</p>

<p>앙상블의 기법은 Begging, Stacking, Boosting 등의 기법이 있으며</p>

<p>Underfitting(High Bias)을 해결하기 위해 Boosting이 주로 자주 사용된다.</p>

<ul>
  <li>정형데이터 등에서도 gradient Boosting이나 XGBoost 같은 방법이 사용된다.</li>
</ul>

<p>Overfitting(High Variance)를 해결하기 위해 Begging이 주로 사용된다.</p>

<ul>
  <li>여러 정답을 취합해서 평균을 내는 방법, Random forest 등이 있음</li>
</ul>

<p><strong>Model Averaging(Voting)</strong></p>

<p><img src="/assets/img/이미지 분류 개념/image-20210402100642568.png" alt=""></p>

<p>앙상블에서 사용하는 방법, 서로 다른 특색을 가진 모델이 애매한 결과들을 냈을 때, 투표를 통하여 답을 구하는 것</p>

<ol>
  <li>One-hot vector로 voting하는 Hard Voting(다수결)이 있고,</li>
  <li>가중치들의 합으로 결정하는 Soft Voting이 있다.
    <ul>
      <li>일반적으로 성능이 더욱 좋다.</li>
    </ul>
  </li>
</ol>

<p><strong>Cross Validation(CV)</strong></p>

<p><img src="/assets/img/이미지 분류 개념/image-20210402101108075.png" alt=""></p>

<p>기존에 Training에 사용하지 않던 Validation set을 학습 시 마다 다른 분포를 사용하여 학습에 이용해 보는 방법</p>

<p><strong>Stratified K-Fold Cross Validation</strong></p>

<p><img src="/assets/img/이미지 분류 개념/image-20210402101630637.png" alt=""></p>

<p>Validation이 생성될 수 있는 모든 경우의 수와 고른 Class 분포까지 고려한 CV</p>

<p>단, K(일반적으로 5개)개 만큼의 모델이 생성되므로, 학습시간이 그만큼 커진다.</p>

<p><strong>TTA(Test Time Augmentation)</strong></p>

<p><img src="/assets/img/이미지 분류 개념/image-20210402102234925.png" alt=""></p>

<p>Test data set을 Augmentation 호 모델 추론, 출력된 여러가지 결과를 앙상블</p>

<h2 id="Hyperparametr-Optimization">Hyperparametr Optimization</h2>

<p>시스템의 매커니즘에 영향을 주는 주요한 파라미터들을 찾아내는 것</p>

<ul>
  <li>Learning rate, Batch size, Hidden Layer 갯수, Loss 파라미터, Dropout, k-fold, Regularization, Optimizer 파라미터 등이 있다.</li>
</ul>

<p>사실, Ensemble 만큼이나 시간과 자원이 많이 필요하지만 성능 상승은 미비하다.</p>

<p>Grid search, Random search, Beysian Optimization 등의 방법이 있음</p>

<ul>
  <li>Beysian Optimization: 이전 결과를 바탕으로 최적의 방법을 찾아가는 방법</li>
</ul>

<p><strong>Optuna library</strong></p>

<p><img src="/assets/img/이미지 분류 개념/image-20210402105132426.png" alt=""></p>

<p>파라미터 범위를 주고 그 범위 안에서 정해진 Trials 만큼 시행하도록 도와줌</p>

<h2 id="Experiment-Toolkits-Tips">Experiment Toolkits &amp; Tips</h2>

<h3 id="Training-Visualization">Training Visualization</h3>

<p><strong>Tensorboard</strong></p>

<p>기존에는 Tensorflow 용이였지만 Pytorch에도 포팅됨, 학습과정을 기록하고 트래킹 가능한 툴</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210402111837533.png" alt=""></p>

<p><img src="/assets/img/이미지 분류 개념/image-20210402111846420.png" alt=""></p>

<p>데이터 확인 등도 가능</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensorboard <span class="nt">--logdir</span> PATH<span class="o">(</span>log가 저장된 경로<span class="o">)</span> <span class="nt">--host</span> ADDR<span class="o">(</span>default localhost<span class="o">)</span> <span class="nt">--port</span> PORT<span class="o">(</span>포트 번호<span class="o">)</span>

</code></pre></div></div>
<p>위와 같은 번호로 사용 가능</p>

<p><strong>Weight and Bias(wandb)</strong></p>

<p>딥러닝 로그계의 깃허브</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210402113812540.png" alt=""></p>

<p><img src="/assets/img/이미지 분류 개념/image-20210402113832831.png" alt=""></p>

<p><img src="/assets/img/이미지 분류 개념/image-20210402113848920.png" alt=""></p>

<p><img src="/assets/img/이미지 분류 개념/image-20210402113907459.png" alt=""></p>

<p>Jupyter Notebook : Cell 마다 사용가능함, EDA시 많이 활용</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210402115425183.png" alt=""></p>

<p>Python IDLE : 디버깅 쉬움, 코드 실행이 안정적임, 자유로운 실험 핸들링</p>

<p>그 외의 팁</p>

<p><img src="/assets/img/이미지 분류 개념/image-20210402120416916.png" alt=""></p>

<ol>
  <li>데이터 분석 코드 시, 코드 자체보단, 필자의 설명글을 유심히 보자</li>
</ol>

<p><img src="/assets/img/이미지 분류 개념/image-20210402120700163.png" alt=""></p>

<ol>
  <li>
    <p>언제나 활용가능하도록 코드를 자세히 이해하자</p>
  </li>
  <li>
    <p>paperwithcode.com 에서 최신 논문과 코드까지</p>
  </li>
  <li>
    <p>자신의 지식을 자주 공유하자.</p>
  </li>
</ol>

</body></html>
</div>

  </div><a class="u-url" href="/articles/AI/CV/%EC%9D%B4%EB%AF%B8%EC%A7%80%20%EB%B6%84%EB%A5%98%20%EA%B0%9C%EB%85%90.html" hidden></a>
  <p class="u-path" hidden>_articles/AI/CV/이미지 분류 개념.md</p>
  <script type="module" src="/assets/scripts/utils/update_recents.js"></script>
</article>

    </div>
  </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">🧠SUBBRAIN</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="a-name">🧠SUBBRAIN</li><li><a class="u-email" href="mailto:roadvirushn@gmail.com">roadvirushn@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li>
    <a href="https://github.com/RoadVirusHN"><svg class="svg-icon">
        <use xlink:href="/assets/svg/social-icons.svg#github"></use>
      </svg>
      <span class="username">RoadVirusHN</span></a>
  </li><!---->
</ul></div>

      <div class="footer-col footer-col-3">
        <p>이것이 디지털 동물의 숲이다!! 파멸편 (This is the Digital Animal Crossing!! Bad Ending.01)</p>
      </div>
    </div>

  </div>

</footer>
</body>

<script src="/assets/scripts/bundle/common.bundle.js"></script>

</html>